# 为什么要使用 webpack

【模块打包工具 webpack】

当我们使用模块化开发的时候，一个文件要引入多个模块文件来正常运行，但是如果要引用的文件很多，就很难管理，webpack 的目的就是帮助我们管理这些模块文件的。

# 初试 webpack

## 未使用 webpack 时的结构

index.html:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hello Webpack</title>
</head>
<body>
    第一次使用 Webpack.
    <div id="root" ></div>
    <script src="./lesson/header.js" ></script>
    <script src="./lesson/sidebar.js" ></script>
    <script src="./lesson/content.js" ></script>
    <script src="./lesson/index.js" ></script>
</body>
</html>
```

header.js：

```js
function Header() {
    let header = document.createElement('div');
    header.innerHTML = 'header';
    dom.append(header);
}
```

sidebar.js：

```js
function Sidebar() {
    let sidebar = document.createElement('div');
    sidebar.innerHTML = 'sidebar';
    dom.append(sidebar);
}
```

content.js：

```js
function Content() {
    let content = document.createElement('div');
    content.innerHTML = 'content';
    dom.append(content);
}
```

index.js：

```js
let dom = document.getElementById('root');

new Header();
new Sidebar();
new Content();
```

上面的代码，文件的引用顺序要注意，index.js 必须放在其他的文件之后，这让代码的维护性降低了。

且上面代码，index.html 要加载三个文件，会让加载速度降低。

## 重构一下

index.html：

```js
<body>
    第一次使用 Webpack.
    <div id="root" ></div>
    <script src="./lesson/dist/main.js" ></script>
</body>
```

index.js：

```js
import Header from './header';
import Sidebar from './sidebar';
import Content from './content';

let dom = document.getElementById('root');

new Header();
new Sidebar();
new Content();
```

这里的问题是：浏览器不能识别 `import` 方法，所以我们要使用 webpack 进行打包，webpack 知道我们的 `import` 的意思。

需要注意：webpack 需要我们使用 ES6 的模块导出语法，所以其他三个文件末尾要加上：

```js
export default Sidebar
```

安装 webpack ：

```shell
$ yarn add -D webpack-cli
$ yarn add webpack
```

在 `index.js` 对应的文件夹下打开终端，使用 webpack 打包一下：

```shell
$ npx webpack index.js
```

意思就是用 webpack 翻译 index.js 这个文件，翻译好的内容在 `dist/main.js` 中。

感觉这时候似乎好了，但是会发现报错：

![81223480](http://free-en-01.oss.tusy.xyz/2020122/4606-khkvje.vya8.png)

我们要改一下上面的代码，哪里使用的 dom 就要放在哪里：

对三个文件做这样的修改

```js
function Sidebar() {
    let dom = document.getElementById('root');  // +
    let sidebar = document.createElement('div');
    sidebar.innerHTML = 'sidebar';
    dom.append(sidebar);
}

export default Sidebar;
```

此时运行程序，就没有错误了。

## 总结

上面我们测试了 webpack 的翻译功能，但实际上 webpack 是模块打包工具，不是翻译器，因为 webpack 只认识 import 这些语句。翻译器还是使用 **Babel**。

